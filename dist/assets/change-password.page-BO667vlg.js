import{r as s,j as e,F as r,z as a}from"./vendor-react-B97CwnuL.js";import{U as t,A as o,a as n}from"./index-DsO7NqaW.js";import{I as i}from"./Input-aJ117DRx.js";import"./vendor-misc-DLsXWmW-.js";import"./vendor-socket-CKUjeMYl.js";import"./vendor-utils-8sZVtwSW.js";import"./vendor-animation-Bq1BCxLt.js";const d=()=>{const d=s.useRef(),{userAuth:{access_token:c}}=s.useContext(t),[l,p]=s.useState(!1),u=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{6,20}$/;return e.jsxs(o,{children:[e.jsx(r,{}),e.jsxs("form",{ref:d,onSubmit:async s=>{s.preventDefault();const e=d.current,r=e.currentPassword.value.trim(),t=e.newPassword.value.trim();if(!r||!t)return a.error("Please fill in all the fields.");if(!u.test(r)||!u.test(t))return a.error("Password must be 6â€“20 chars, with at least one special char, one digit, one uppercase & one lowercase letter.");if(r===t)return a.error("New password must differ from the current one.");p(!0);const o=a.loading("Updating passwordâ€¦");try{const s=await n.post("/change-password",{currentPassword:r,newPassword:t},{headers:{"Content-Type":"application/json"},validateStatus:()=>!0});a.dismiss(o),s.status>=200&&s.status<300?(a.success(s.data.message),e.reset()):a.error(s.data.error||`Error ${s.status}: please try again.`)}catch(i){a.dismiss(o),a.error("Network error. Please check your connection.")}finally{p(!1)}},children:[e.jsx("h1",{className:"max-md:hidden",children:"Update Password"}),e.jsxs("div",{className:"py-10 w-full md:max-w-[400px] flex flex-col gap-5",children:[e.jsx(i,{name:"currentPassword",type:"password",className:"profile-edit-input",placeholder:"Current Password",icon:"fi-rr-unlock"}),e.jsx(i,{name:"newPassword",type:"password",className:"profile-edit-input",placeholder:"New Password",icon:"fi-rr-unlock"}),e.jsx("button",{type:"submit",className:"btn-dark px-10 "+(l?"opacity-50 cursor-not-allowed":""),disabled:l,children:l?"Updatingâ€¦":"Update Password"})]})]})]})};export{d as default};
