import{q as e,u as s,r as t,j as r,H as a}from"./vendor-react-B97CwnuL.js";import{c as n,N as i,a as o,d as l}from"./index-RWwxXIM8.js";import{S as c}from"./StoryCard-Bt_p9rFO.js";import"./vendor-misc-DLsXWmW-.js";import"./vendor-socket-CKUjeMYl.js";import"./vendor-utils-8sZVtwSW.js";import"./vendor-animation-Bq1BCxLt.js";const d=()=>r.jsx("div",{className:"w-full h-48 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}),g=(e,s=4)=>{const t=[];return e.forEach((e,a)=>{t.push(e),(a+1)%s===0&&t.push(r.jsx("div",{className:"col-span-full lg:col-span-4",children:r.jsx(l,{})},`ad-${a}`))}),t};function m(){const{pathname:l}=e(),m=s(),u=l.includes("trending"),x=u?"/trending-stories-pagination":"/stories-pagination-latest",h=u?"Trending Stories":"Latest Stories",[p,j]=t.useState([]),[b,y]=t.useState(null),[f,v]=t.useState(!0),[k,S]=t.useState(!0),N=t.useRef(),w=async(e=null)=>{S(!0);try{const{data:s}=await o.post(x,{limit:8,cursor:e});if(j(t=>e?[...t,...s.stories]:s.stories),v(s.hasMore),s.stories.length){const e=s.stories[s.stories.length-1];y(u?e.trendingScore:e.publishedAt)}}catch(s){}finally{S(!1)}};t.useEffect(()=>{j([]),y(null),v(!0),w()},[l]);const C=t.useCallback(e=>{k||(N.current&&N.current.disconnect(),N.current=new IntersectionObserver(e=>{e[0].isIntersecting&&f&&w(b)},{rootMargin:"200px"}),e&&N.current.observe(e))},[k,f,b]),L=({label:e,active:s,onClick:t})=>r.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium rounded-md transition-colors duration-300 "+(s?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-blue-100 dark:hover:bg-gray-700"),children:e});return r.jsxs(r.Fragment,{children:[r.jsxs(a,{children:[r.jsxs("title",{children:[h," | Shumse"]}),r.jsx("meta",{name:"description",content:`Stay updated with the ${h.toLowerCase()}. Fast, SEO-optimized.`})]}),r.jsx(n,{}),r.jsxs("div",{className:"max-w-7xl mx-auto p-4",children:[r.jsxs("div",{className:"mb-6 flex justify-center space-x-4",children:[r.jsx(L,{label:"Latest",active:!u,onClick:()=>m("/stories")}),r.jsx(L,{label:"Trending",active:u,onClick:()=>m("/stories/trending")})]}),r.jsx("h1",{className:"text-3xl font-bold mb-6 text-gray-900 dark:text-gray-100",children:h}),!k&&0===p.length&&r.jsx(i,{pageType:"story"}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:k&&0===p.length?Array(8).fill().map((e,s)=>r.jsx(d,{},s)):g(p.map((e,s)=>{const t=r.jsx(c,{story:e},e.story_id);return s===p.length-1?r.jsx("div",{ref:C,children:t},e.story_id):t}),4)}),!k&&f&&r.jsx("div",{className:"mt-8 text-center",children:r.jsx("button",{onClick:()=>w(b),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition",children:"Load More"})})]})]})}export{m as default};
