import{j as s}from"./vendor-markdown-DVKDwQVh.js";import{O as e,V as r}from"./vendor-ui-BqXYh4xT.js";import{U as a,A as t,a as o}from"./index-D1ni5E-J.js";import{I as n}from"./Input-BuC4wpFo.js";import{r as d}from"./vendor-react-B32pNUrn.js";import"./vendor-socket-CUkmNz_4.js";const i=()=>{const i=d.useRef(),{userAuth:{access_token:c}}=d.useContext(a),[l,p]=d.useState(!1),u=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{6,20}$/;return s.jsxs(t,{children:[s.jsx(e,{}),s.jsxs("form",{ref:i,onSubmit:async s=>{s.preventDefault();const e=i.current,a=e.currentPassword.value.trim(),t=e.newPassword.value.trim();if(!a||!t)return r.error("Please fill in all the fields.");if(!u.test(a)||!u.test(t))return r.error("Password must be 6â€“20 chars, with at least one special char, one digit, one uppercase & one lowercase letter.");if(a===t)return r.error("New password must differ from the current one.");p(!0);const n=r.loading("Updating passwordâ€¦");try{const s=await o.post("/change-password",{currentPassword:a,newPassword:t},{headers:{"Content-Type":"application/json"},validateStatus:()=>!0});r.dismiss(n),s.status>=200&&s.status<300?(r.success(s.data.message),e.reset()):r.error(s.data.error||`Error ${s.status}: please try again.`)}catch(d){r.dismiss(n),r.error("Network error. Please check your connection.")}finally{p(!1)}},children:[s.jsx("h1",{className:"max-md:hidden",children:"Update Password"}),s.jsxs("div",{className:"py-10 w-full md:max-w-[400px] flex flex-col gap-5",children:[s.jsx(n,{name:"currentPassword",type:"password",className:"profile-edit-input",placeholder:"Current Password",icon:"fi-rr-unlock"}),s.jsx(n,{name:"newPassword",type:"password",className:"profile-edit-input",placeholder:"New Password",icon:"fi-rr-unlock"}),s.jsx("button",{type:"submit",className:"btn-dark px-10 "+(l?"opacity-50 cursor-not-allowed":""),disabled:l,children:l?"Updatingâ€¦":"Update Password"})]})]})]})};export{i as default};
