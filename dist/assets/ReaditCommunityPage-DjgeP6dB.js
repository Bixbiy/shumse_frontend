import{j as e,m as t,r as a,u as r,U as s,a as l,e as i,H as d,L as n}from"./index-vd7Ycuse.js";import{u as o,R as c}from"./ReaditPostCard-Dizyj04C.js";import"./VoteButtons-C0Wsn74s.js";import"./PostFlair-CoCmiIP4.js";const x=({status:a})=>{if(!a||"approved"===a)return null;const r=(()=>{switch(a){case"pending":return{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-800 dark:text-yellow-300",icon:"fi-rr-clock",label:"Pending Approval"};case"rejected":return{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-800 dark:text-red-300",icon:"fi-rr-cross-circle",label:"Rejected"};case"deleted":return{bg:"bg-gray-100 dark:bg-gray-900/30",text:"text-gray-800 dark:text-gray-300",icon:"fi-rr-trash",label:"Deleted"};default:return null}})();return r?e.jsxs(t.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-bold ${r.bg} ${r.text}`,children:[e.jsx("i",{className:`fi ${r.icon}`}),r.label]}):null},m=({banner:r,communityName:s,className:l=""})=>{const[i,d]=a.useState(!1);return!r||i?e.jsx("div",{className:`w-full h-32 md:h-48 bg-gradient-to-r from-blue-500 to-purple-600 ${l}`,style:{backgroundImage:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full h-full bg-black/20 flex items-center justify-center",children:e.jsxs("h2",{className:"text-white text-3xl md:text-5xl font-bold drop-shadow-lg",children:["c/",s]})})}):e.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},className:`w-full h-32 md:h-48 overflow-hidden ${l}`,children:e.jsx("img",{src:r,alt:`${s} banner`,className:"w-full h-full object-cover",onError:()=>d(!0),loading:"lazy"})})},g=()=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-4 mb-4 shadow-sm border border-gray-200 dark:border-slate-800 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-slate-800 rounded-full"}),e.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-slate-800 rounded"})]}),e.jsx("div",{className:"h-6 w-3/4 bg-gray-200 dark:bg-slate-800 rounded mb-2"}),e.jsx("div",{className:"h-20 w-full bg-gray-200 dark:bg-slate-800 rounded"})]}),b=({message:t="An error occurred"})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-full mb-4",children:e.jsx("i",{className:"fi fi-rr-exclamation text-3xl text-orange-500"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t}),e.jsx(n,{to:"/readit",className:"mt-4 text-indigo-500 hover:underline",children:"Return to Home"})]}),u=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 p-6 rounded-full mb-6",children:e.jsx("i",{className:"fi fi-rr-search-alt text-5xl text-gray-400"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Community Not Found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-8 max-w-md",children:"The community you are looking for doesn't exist or has been removed."}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(n,{to:"/readit",className:"btn-light px-6 py-2 rounded-full",children:"Go Home"}),e.jsx(n,{to:"/readit/create-community",className:"btn-dark px-6 py-2 rounded-full",children:"Create Community"})]})]}),h=()=>{var h,y,f,p;const{communityName:j}=r(),{userAuth:N}=a.useContext(s),[v,k]=a.useState(null),[w,C]=a.useState(!0),[S,$]=a.useState(null),[L,P]=a.useState(!1),[A,_]=a.useState(!1),{posts:F,isLoading:M,isFetchingMore:R,hasMore:z,sort:D,setSort:E,loadMore:H}=o("hot",j),J=a.useCallback(async()=>{var e;C(!0),$(null);try{const{data:e}=await l.get(`/readit/c/${j}`);k(e),(null==N?void 0:N.access_token)&&e.members&&P(e.members.includes(N._id))}catch(t){$(404===(null==(e=t.response)?void 0:e.status)?"not_found":"error")}finally{C(!1)}},[j,N]);a.useEffect(()=>{J()},[J]);return w?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(i,{})}):"not_found"===S?e.jsx(u,{}):S?e.jsx(b,{message:"Failed to load community"}):v?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-black",children:[e.jsxs(d,{children:[e.jsxs("title",{children:[v.title," (c/",v.name,") | Readit"]}),e.jsx("meta",{name:"description",content:v.description||v.metaDescription||`Join c/${v.name} - ${v.title}`}),v.keywords&&e.jsx("meta",{name:"keywords",content:v.keywords.join(", ")})]}),e.jsx(m,{banner:v.banner,communityName:v.name}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-neutral-900 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-6 -mt-8 relative z-10",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:v.icon?e.jsx("img",{src:v.icon,alt:v.name,className:"w-full h-full rounded-xl object-cover",onError:e=>{e.target.style.display="none"}}):e.jsx("span",{className:"text-3xl font-bold text-white",children:v.name[0].toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap mb-2",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white",children:v.title}),e.jsx(x,{status:v.status})]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-1",children:["c/",v.name]}),v.description&&e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mt-3",children:v.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("i",{className:"fi fi-rr-users"}),e.jsxs("span",{className:"font-medium",children:[(null==(h=v.memberCount)?void 0:h.toLocaleString())||0," members"]})]}),void 0!==v.postCount&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("i",{className:"fi fi-rr-document"}),e.jsxs("span",{className:"font-medium",children:[null==(y=v.postCount)?void 0:y.toLocaleString()," posts"]})]})]})]}),e.jsx("button",{onClick:async()=>{if(!(null==N?void 0:N.access_token))return window.location.href="/signin";_(!0);try{await l.post(`/readit/c/${j}/join`),P(!L),k(e=>({...e,memberCount:e.memberCount+(L?-1:1)}))}catch(e){}finally{_(!1)}},disabled:A,className:`px-6 py-2.5 rounded-full font-bold transition-all ${L?"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600":"bg-blue-600 hover:bg-blue-700 text-white shadow-lg hover:shadow-xl"} disabled:opacity-50 disabled:cursor-not-allowed`,children:A?"Loading...":L?"Joined":"Join"})]}),e.jsxs(n,{to:`/readit/c/${v.name}/submit`,className:"mt-6 w-full flex items-center justify-center gap-2 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white py-3 rounded-xl font-bold transition-all shadow-lg",children:[e.jsx("i",{className:"fi fi-rr-edit"}),"Create Post"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"flex items-center gap-2 mb-4 overflow-x-auto",children:["hot","new","top"].map(t=>e.jsx("button",{onClick:()=>E(t),className:"px-4 py-2 rounded-full font-medium capitalize transition-all whitespace-nowrap "+(D===t?"bg-blue-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"),children:t},t))}),e.jsxs("div",{className:"space-y-4",children:[M?Array(5).fill(0).map((t,a)=>e.jsx(g,{},a)):0===F.length?e.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-xl p-12 text-center border border-gray-200 dark:border-gray-800",children:[e.jsx("i",{className:"fi fi-rr-document text-5xl text-gray-300 dark:text-gray-700 mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"No posts yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Be the first to post in this community!"}),e.jsxs(n,{to:`/readit/c/${v.name}/submit`,className:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-bold transition-colors",children:[e.jsx("i",{className:"fi fi-rr-edit"}),"Create First Post"]})]}):F.map(t=>e.jsx(c,{post:t},t._id)),z&&e.jsx("button",{onClick:H,disabled:R,className:"w-full py-3 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl font-medium transition-colors disabled:opacity-50",children:R?"Loading...":"Load More Posts"})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-xl p-6 border border-gray-200 dark:border-gray-800 sticky top-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"About Community"}),v.description&&e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm mb-4 leading-relaxed",children:v.description}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-gray-100 dark:border-gray-800",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Members"}),e.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:(null==(f=v.memberCount)?void 0:f.toLocaleString())||0})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-gray-100 dark:border-gray-800",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Posts"}),e.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:(null==(p=v.postCount)?void 0:p.toLocaleString())||0})]}),v.createdAt&&e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-gray-100 dark:border-gray-800",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Created"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:new Date(v.createdAt).toLocaleDateString()})]})]})]})})]})]})]}):e.jsx(b,{message:"Community data unavailable"})};export{h as default};
