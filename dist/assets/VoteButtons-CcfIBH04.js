import{j as e}from"./vendor-markdown-DVKDwQVh.js";import{r}from"./vendor-react-B32pNUrn.js";import{U as t}from"./index-D1ni5E-J.js";import{v as o,a}from"./useReaditApi-CKGJs4Kf.js";import{V as n}from"./vendor-ui-BqXYh4xT.js";const s=(e,r="Something went wrong")=>{var t,o;const a=(null==(o=null==(t=e.response)?void 0:t.data)?void 0:o.error)||r;return n.error(a),a},i=({item:i,isComment:l=!1})=>{const{userAuth:u}=r.useContext(t);if(!i)return null;const[d,c]=r.useState(i.score||0),[m,x]=r.useState(i.userVote||"none"),[p,f]=r.useState(!1);r.useEffect(()=>{c(i.score||0),x(i.userVote||"none")},[i.score,i.userVote]);const g=async e=>{if(!(null==u?void 0:u.access_token))return n.error("Please login to vote");if(p)return;const r=m,t=d;let g=e;r===e&&(g="none");let v=d;"up"===r&&v--,"down"===r&&v++,"up"===g&&v++,"down"===g&&v--,x(g),c(v),f(!0);try{const e=l?o:a;await e(i._id,g)}catch(w){s(w,"Vote failed"),x(r),c(t)}finally{f(!1)}};return e.jsxs("div",{className:"flex flex-col items-center "+(l?"gap-0":"gap-1"),children:[e.jsx("button",{onClick:()=>g("up"),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors "+("up"===m?"text-orange-500":"text-gray-400 hover:text-orange-500"),"aria-label":"Upvote",children:e.jsx("i",{className:`fi ${"up"===m?"fi-sr-arrow-square-up":"fi-rr-arrow-square-up"} text-2xl`,"aria-hidden":"true"})}),e.jsx("span",{className:"text-sm font-bold "+("up"===m?"text-orange-500":"down"===m?"text-blue-500":"text-black dark:text-white"),children:Intl.NumberFormat("en-US",{notation:"compact"}).format(d)}),e.jsx("button",{onClick:()=>g("down"),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors "+("down"===m?"text-blue-500":"text-gray-400 hover:text-blue-500"),"aria-label":"Downvote",children:e.jsx("i",{className:`fi ${"down"===m?"fi-sr-arrow-square-down":"fi-rr-arrow-square-down"} text-2xl`,"aria-hidden":"true"})})]})};export{i as V,s as h};
