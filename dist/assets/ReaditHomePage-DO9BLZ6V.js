import{B as e,C as r,r as a,M as s,D as t,J as i,K as o,O as n,Q as l,b as d,j as c,m as x,A as m,U as g,H as h,L as u,a as y}from"./index-CuIw7dka.js";import{R as b,u as p}from"./ReaditPostCard-CSzERypT.js";import{P as f}from"./PageTransition-DHdyIg2G.js";import"./VoteButtons-DGeJ6ruv.js";import"./PostFlair-CDd9ODzC.js";function j(t){const i=e(()=>r(t)),{isStatic:o}=a.useContext(s);if(o){const[,e]=a.useState(t);a.useEffect(()=>i.on("change",e),[])}return i}function v(e,r){const a=j(r()),s=()=>a.set(r());return s(),i(()=>{const r=()=>o.update(s,!1,!0),a=e.map(e=>e.on("change",r));return()=>{a.forEach(e=>e()),n(s)}}),a}function N(e,r,a,s){if("function"==typeof e)return function(e){l.current=[],e();const r=v(l.current,e);return l.current=void 0,r}(e);const i="function"==typeof r?r:function(...e){const r=!Array.isArray(e[0]),a=r?0:-1,s=e[0+a],i=e[1+a],o=e[2+a],n=e[3+a],l=t(i,o,{mixer:(d=o[0],(e=>e&&"object"==typeof e&&e.mix)(d)?d.mix:void 0),...n});var d;return r?l(s):l}(r,a,s);return Array.isArray(e)?w(e,i):w([e],([e])=>i(e))}function w(r,a){const s=e(()=>[]);return v(r,()=>{s.length=0;const e=r.length;for(let a=0;a<e;a++)s[a]=r[a].get();return a(s)})}const k=()=>c.jsx("div",{className:"bg-white dark:bg-neutral-900 rounded-xl p-4 mb-4 border border-gray-200 dark:border-gray-800 animate-pulse",children:c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded"}),c.jsx("div",{className:"w-6 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),c.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded"})]}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx("div",{className:"w-6 h-6 bg-gray-200 dark:bg-gray-700 rounded-full"}),c.jsx("div",{className:"h-3 w-24 bg-gray-200 dark:bg-gray-700 rounded"}),c.jsx("div",{className:"h-3 w-16 bg-gray-200 dark:bg-gray-700 rounded"})]}),c.jsx("div",{className:"h-6 w-3/4 bg-gray-200 dark:bg-gray-700 rounded mb-3"}),c.jsx("div",{className:"h-4 w-full bg-gray-200 dark:bg-gray-700 rounded mb-2"}),c.jsx("div",{className:"h-4 w-2/3 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),c.jsxs("div",{className:"flex gap-4",children:[c.jsx("div",{className:"h-8 w-20 bg-gray-200 dark:bg-gray-700 rounded"}),c.jsx("div",{className:"h-8 w-16 bg-gray-200 dark:bg-gray-700 rounded"})]})]})]})}),C=({posts:e,isLoading:r,isFetchingMore:s,hasMore:t,loadMore:i,communityId:o})=>{const n=a.useRef(null),{socket:l}=d();a.useEffect(()=>{if(!n.current||!t)return;const e=new IntersectionObserver(e=>{e[0].isIntersecting&&!s&&t&&i()},{threshold:.1,rootMargin:"100px"});return e.observe(n.current),()=>e.disconnect()},[t,s,i]);const g={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.3}}};return r?c.jsx("div",{className:"space-y-4",children:Array(5).fill(0).map((e,r)=>c.jsx(k,{},r))}):0===e.length?c.jsxs(x.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white dark:bg-neutral-900 rounded-xl p-12 text-center border border-gray-200 dark:border-gray-800",children:[c.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center",children:c.jsx("i",{className:"fi fi-rr-document text-4xl text-gray-400"})}),c.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"No posts yet"}),c.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Be the first to share something!"})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsx(m,{mode:"popLayout",children:c.jsx(x.div,{variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.08}}},initial:"hidden",animate:"visible",className:"space-y-4",children:e.map((e,r)=>c.jsx(x.div,{variants:g,layout:!0,layoutId:e._id,children:c.jsx(b,{post:e})},e._id))})}),t&&c.jsx("div",{ref:n,className:"py-4",children:s&&c.jsxs("div",{className:"flex items-center justify-center gap-3",children:[c.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),c.jsx("span",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"Loading more posts..."})]})}),!t&&e.length>0&&c.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},className:"py-8 text-center",children:c.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-400 dark:text-gray-500",children:[c.jsx("i",{className:"fi fi-rr-check-circle"}),c.jsx("span",{children:"You've seen all posts"})]})})]})},S=({onRefresh:e,children:r,threshold:s=80})=>{const[t,i]=a.useState(!1),o=a.useRef(null),n=a.useRef(0),l=j(0),d=N(l,[0,s],[0,360]),m=N(l,[0,s/2,s],[0,.5,1]),g=N(l,[0,s],[.5,1]),h=a.useCallback(e=>{var r;0===(null==(r=o.current)?void 0:r.scrollTop)&&(n.current=e.touches[0].clientY)},[]),u=a.useCallback(e=>{var r;if(t)return;const a=e.touches[0].clientY-n.current;a>0&&0===(null==(r=o.current)?void 0:r.scrollTop)&&l.set(Math.min(.5*a,1.5*s))},[t,l,s]),y=a.useCallback(async()=>{if(l.get()>=s&&!t){i(!0);try{await e()}catch(r){}finally{i(!1)}}l.set(0)},[l,s,t,e]);return c.jsxs("div",{ref:o,onTouchStart:h,onTouchMove:u,onTouchEnd:y,className:"relative h-full overflow-y-auto",children:[c.jsx(x.div,{style:{height:l,opacity:m},className:"absolute top-0 left-0 right-0 flex items-center justify-center overflow-hidden bg-gradient-to-b from-gray-100 dark:from-gray-800 to-transparent",children:c.jsx(x.div,{style:{scale:g,rotate:d},className:"w-8 h-8 flex items-center justify-center",children:t?c.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):c.jsx("i",{className:"fi fi-rr-refresh text-xl text-blue-500"})})}),c.jsx(x.div,{style:{y:t?40:0},transition:{type:"spring",stiffness:300,damping:30},children:r})]})},R=a.memo(({option:e,active:r,onClick:a,icon:s})=>c.jsxs(x.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>a(e),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl font-bold text-sm transition-all duration-300 "+(r?"bg-gradient-to-r from-orange-500 to-orange-700 text-white shadow-lg shadow-orange-500/30":"bg-white/80 dark:bg-gray-800/80 text-gray-700 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-700 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50"),children:[c.jsx("i",{className:`fi ${s}`}),c.jsx("span",{className:"capitalize",children:e})]})),M=a.memo(({community:e})=>{var r;return c.jsx(x.div,{whileHover:{scale:1.02,y:-2},initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"group",children:c.jsxs(u,{to:`/readit/c/${e.name}`,className:"flex items-center gap-3 p-3 rounded-xl bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 hover:border-orange-300 dark:hover:border-orange-600 transition-all duration-300",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 flex items-center justify-center text-white font-bold shadow-lg overflow-hidden",children:e.icon?c.jsx("img",{src:e.icon,alt:"",className:"w-full h-full object-cover",onError:e=>e.target.style.display="none"}):e.name[0].toUpperCase()}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("p",{className:"font-bold text-gray-900 dark:text-white truncate group-hover:text-orange-500 transition-colors",children:["c/",e.name]}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(null==(r=e.memberCount)?void 0:r.toLocaleString())||0," members"]})]}),c.jsx("i",{className:"fi fi-rr-angle-small-right text-gray-400 group-hover:text-orange-500 group-hover:translate-x-1 transition-all"})]})})}),P=({communities:e})=>e&&0!==e.length?c.jsx("div",{className:"w-full overflow-hidden bg-orange-500/10 border-y border-orange-500/20 py-2 mb-6 backdrop-blur-sm",children:c.jsx("div",{className:"flex whitespace-nowrap animate-scroll",children:[...e,...e].map((e,r)=>c.jsxs(u,{to:`/readit/c/${e.name}`,className:"inline-flex items-center gap-2 mx-6 text-sm font-bold text-gray-700 dark:text-gray-200 hover:text-orange-500 transition-colors",children:[c.jsx("span",{className:"text-orange-500",children:"#"}),e.name,c.jsx("span",{className:"text-xs font-normal text-gray-500 opacity-70",children:Intl.NumberFormat("en-US",{notation:"compact"}).format(e.memberCount)})]},`${e._id}-${r}`))})}):null,A=()=>c.jsx("div",{className:"space-y-3 animate-pulse",children:Array(5).fill(0).map((e,r)=>c.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-gray-100 dark:bg-gray-800",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-200 dark:bg-gray-700"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"h-4 w-24 bg-gray-200 dark:bg-gray-700 rounded mb-1"}),c.jsx("div",{className:"h-3 w-16 bg-gray-200 dark:bg-gray-700 rounded"})]})]},r))}),T=()=>{const{userAuth:e}=a.useContext(g),{socket:r}=d(),{posts:s,isLoading:t,isFetchingMore:i,hasMore:o,sort:n,setSort:l,activeTab:b,setActiveTab:j,loadMore:v,isLoggedIn:N,refresh:w}=p("hot"),[k,T]=a.useState([]),[z,E]=a.useState(!0),[F,L]=a.useState(!1);a.useEffect(()=>{(async()=>{E(!0);try{const{data:e}=await y.get("/readit/communities/popular");T(e||[])}catch(e){}finally{E(!1)}})()},[]),a.useEffect(()=>{if(r)return r.on("newReaditPost",e=>{}),()=>r.off("newReaditPost")},[r]),a.useEffect(()=>(document.body.style.overflow=F?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[F]);const Y=a.useCallback(async()=>{w&&await w()},[w]),I=[{key:"hot",icon:"fi-rr-flame"},{key:"new",icon:"fi-rr-sparkles"},{key:"top",icon:"fi-rr-trophy"}];return c.jsx(f,{children:c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 dark:from-gray-950 dark:via-gray-900 dark:to-black transition-colors duration-300",children:[c.jsxs(h,{children:[c.jsx("title",{children:"Readit by Shums | Discover, Share, Connect"}),c.jsx("meta",{name:"description",content:"Join Readit - the modern community platform where ideas come alive. Share stories, discover trends, and connect with passionate communities."}),c.jsx("meta",{name:"keywords",content:"readit, community, forum, discussion, social, trends, posts"}),c.jsx("meta",{property:"og:title",content:"Readit by Shums | Discover, Share, Connect"}),c.jsx("meta",{property:"og:description",content:"The modern community platform where ideas come alive"}),c.jsx("meta",{property:"og:type",content:"website"}),c.jsx("link",{rel:"canonical",href:window.location.origin+"/readit"})]}),c.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-orange-500/5 dark:bg-orange-500/10 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-purple-500/5 dark:bg-purple-500/10 rounded-full blur-3xl"})]}),c.jsx("div",{className:"md:hidden sticky top-[60px] z-40 px-4 py-3",children:c.jsxs("div",{className:"bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl rounded-2xl border border-gray-200/50 dark:border-gray-800/50 shadow-lg p-3",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("button",{onClick:()=>L(!0),className:"flex items-center gap-2 px-3 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[c.jsx("i",{className:"fi fi-rr-menu-burger text-lg dark:text-white"}),c.jsx("span",{className:"font-bold bg-gradient-to-r from-orange-500 to-orange-700 bg-clip-text text-transparent",children:"Readit"})]}),c.jsxs(u,{to:"/readit/create-post",className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-700 text-white rounded-xl font-bold shadow-lg shadow-orange-500/30 hover:shadow-xl transition-shadow",children:[c.jsx("i",{className:"fi fi-rr-plus"}),c.jsx("span",{className:"hidden xs:inline",children:"Create"})]})]}),c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:I.map(({key:e,icon:r})=>c.jsx(R,{option:e,active:n===e,onClick:l,icon:r},e))})]})}),c.jsx(m,{children:F&&c.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[c.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>L(!1)}),c.jsxs(x.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",damping:25,stiffness:300},className:"absolute left-0 top-0 bottom-0 w-[85%] max-w-sm bg-white dark:bg-gray-900 shadow-2xl overflow-y-auto",children:[c.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-700 p-6 z-10",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Readit"}),c.jsx("button",{onClick:()=>L(!1),className:"p-2 rounded-xl bg-white/20 text-white hover:bg-white/30 transition-colors",children:c.jsx("i",{className:"fi fi-rr-cross-small text-xl"})})]}),c.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Discover communities"})]}),c.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-800",children:c.jsxs("div",{className:"space-y-2",children:[c.jsxs(u,{to:"/readit",className:"flex items-center gap-3 p-3 rounded-xl bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 font-medium",children:[c.jsx("i",{className:"fi fi-rr-home"})," Home"]}),N&&c.jsxs(u,{to:"/readit/create-community",className:"flex items-center gap-3 p-3 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors dark:text-white",children:[c.jsx("i",{className:"fi fi-rr-plus-small"})," Create Community"]})]})}),c.jsxs("div",{className:"p-4",children:[c.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-4",children:"ðŸ”¥ Popular Communities"}),z?c.jsx(A,{}):k.length>0?c.jsx("div",{className:"space-y-2",children:k.map(e=>c.jsx(M,{community:e},e._id))}):c.jsx("p",{className:"text-gray-500 text-center py-4",children:"No communities yet"})]})]})]})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 relative z-10",children:[c.jsx("div",{className:"hidden md:block",children:c.jsx(P,{communities:k})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[c.jsxs("div",{className:"lg:col-span-8",children:[c.jsx("div",{className:"hidden md:block mb-6",children:c.jsx("div",{className:"bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl rounded-2xl border border-gray-200/50 dark:border-gray-800/50 shadow-lg p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex bg-gray-100 dark:bg-gray-800 rounded-xl p-1",children:["Popular Posts","Your Feed"].map(e=>c.jsx("button",{onClick:()=>j(e),disabled:"Your Feed"===e&&!N,className:`px-5 py-2.5 rounded-lg font-bold text-sm transition-all ${b===e?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"} disabled:opacity-40 disabled:cursor-not-allowed`,children:e},e))}),c.jsx("div",{className:"flex gap-2",children:I.map(({key:e,icon:r})=>c.jsx(R,{option:e,active:n===e,onClick:l,icon:r},e))})]})})}),c.jsxs(u,{to:"/readit/create-post",className:"hidden md:flex items-center gap-4 p-4 mb-6 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl rounded-2xl border border-gray-200/50 dark:border-gray-800/50 shadow-lg hover:border-orange-300 dark:hover:border-orange-600 transition-all group",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-orange-500 to-orange-700 flex items-center justify-center text-white shadow-lg group-hover:scale-110 transition-transform",children:c.jsx("i",{className:"fi fi-rr-edit text-xl"})}),c.jsx("div",{className:"flex-1",children:c.jsx("p",{className:"text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-300 transition-colors",children:"Create a post..."})}),c.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-700 text-white rounded-xl font-bold shadow-lg shadow-orange-500/30 group-hover:shadow-xl transition-shadow",children:"Post"})]}),c.jsx(S,{onRefresh:Y,children:c.jsx(C,{posts:s,isLoading:t,isFetchingMore:i,hasMore:o,loadMore:v})})]}),c.jsx("div",{className:"hidden lg:block lg:col-span-4",children:c.jsxs("div",{className:"sticky top-[80px] space-y-6",children:[c.jsxs("div",{className:"bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl rounded-2xl border border-gray-200/50 dark:border-gray-800/50 shadow-lg overflow-hidden",children:[c.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-700 p-4",children:c.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[c.jsx("i",{className:"fi fi-rr-flame"})," Popular Communities"]})}),c.jsx("div",{className:"p-4 space-y-3",children:z?c.jsx(A,{}):k.length>0?k.slice(0,5).map(e=>c.jsx(M,{community:e},e._id)):c.jsxs("div",{className:"text-center py-6",children:[c.jsx("i",{className:"fi fi-rr-users text-4xl text-gray-300 dark:text-gray-700 mb-2"}),c.jsx("p",{className:"text-gray-500",children:"No communities yet"})]})}),c.jsx(u,{to:"/readit/communities",className:"block p-4 text-center text-orange-500 hover:text-orange-600 font-bold border-t border-gray-200 dark:border-gray-800 hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors",children:"View All Communities â†’"})]}),N&&c.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gradient-to-br from-purple-500 via-pink-500 to-orange-700 rounded-2xl p-6 text-white shadow-xl relative overflow-hidden group",children:[c.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:c.jsx("i",{className:"fi fi-rr-users-alt text-9xl"})}),c.jsx("h3",{className:"text-xl font-bold mb-2 relative z-10",children:"Start Your Community"}),c.jsx("p",{className:"text-white/80 text-sm mb-4 relative z-10",children:"Create a space for your interests and connect with like-minded people."}),c.jsxs(u,{to:"/readit/create-community",className:"block w-full py-3 bg-white text-gray-900 rounded-xl font-bold text-center hover:bg-gray-100 transition-colors relative z-10",children:[c.jsx("i",{className:"fi fi-rr-plus mr-2"})," Create Community"]})]}),c.jsxs("div",{className:"text-center text-xs text-gray-400 dark:text-gray-600 space-y-2",children:[c.jsxs("p",{children:["Â© ",(new Date).getFullYear()," Readit by Shums"]}),c.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[c.jsx(u,{to:"/about",className:"hover:text-gray-600 dark:hover:text-gray-400",children:"About"}),c.jsx(u,{to:"/privacy",className:"hover:text-gray-600 dark:hover:text-gray-400",children:"Privacy"}),c.jsx(u,{to:"/terms",className:"hover:text-gray-600 dark:hover:text-gray-400",children:"Terms"})]})]})]})})]})]}),c.jsx("style",{jsx:!0,children:"\n                    @keyframes scroll {\n                        0% { transform: translateX(0); }\n                        100% { transform: translateX(-50%); }\n                    }\n                    .animate-scroll {\n                        animation: scroll 30s linear infinite;\n                    }\n                    .animate-scroll:hover {\n                        animation-play-state: paused;\n                    }\n                "})]})})};export{T as default};
