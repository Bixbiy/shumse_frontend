import{r as e,U as t,j as s,L as a,a as r,n as l,c as o,z as i,p as n,P as d,b as c,V as m,f as x,A as u,m as g,d as h,e as p,N as y,u as b,g as f,h as v,E as j,S as w,F as k}from"./index-CuIw7dka.js";import{u as N}from"./index-BAG7TkaQ.js";const _=({small:o=!1})=>{const{userAuth:{access_token:i,username:n}}=e.useContext(t),{blog:d,setBlog:c,setCommentsWrapper:m}=e.useContext(te),[x,u]=e.useState(!1),[g,h]=e.useState(!1),p=window.location.href;e.useEffect(()=>{(async()=>{if(i&&(null==d?void 0:d._id))try{const{data:t}=await r.get(`/check-like/${d._id}`);e.startTransition(()=>{c(e=>{var s;return{...e,activity:{...e.activity,isLikedByUser:t.is_liked,total_likes:t.total_likes??(null==(s=e.activity)?void 0:s.total_likes)??0}}})})}catch(t){}})()},[i,null==d?void 0:d._id,c]);if(!d||!d.title)return null;const{title:y,blog_id:b,_id:f,activity:v,authorId:j}=d,{total_comments:w=0}=v||{},{username:k}=(null==j?void 0:j.personal_info)||{};return s.jsxs(s.Fragment,{children:[!o&&s.jsx("hr",{className:"border-dark-grey/50 my-3"}),s.jsxs("div",{className:"flex justify-between items-center "+(o?"w-full":""),children:[s.jsxs("div",{className:"flex gap-3 items-center",children:[s.jsx("button",{onClick:async()=>{var t,s;if(!i)return void l.error("Please login to like this post");h(!0);const a=d.activity;e.startTransition(()=>{c(e=>{var t,s,a,r;return{...e,activity:{...e.activity,isLikedByUser:!(null==(t=e.activity)?void 0:t.isLikedByUser),total_likes:(null==(s=e.activity)?void 0:s.isLikedByUser)?((null==(r=e.activity)?void 0:r.total_likes)||0)-1:((null==(a=e.activity)?void 0:a.total_likes)||0)+1}}})});try{const{data:t}=await r.post("/like-post",{_id:d._id});e.startTransition(()=>{c(e=>({...e,activity:{...e.activity,isLikedByUser:t.liked_by_user,total_likes:t.total_likes}}))})}catch(o){e.startTransition(()=>{c(e=>({...e,activity:a}))}),l.error((null==(s=null==(t=o.response)?void 0:t.data)?void 0:s.error)||"Failed to update like status")}finally{h(!1)}},disabled:g,"aria-label":(null==v?void 0:v.isLikedByUser)?"Unlike post":"Like post",className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 ${(null==v?void 0:v.isLikedByUser)?"bg-red/10 text-red hover:bg-red/20 scale-110":"bg-grey/20 text-dark-grey hover:bg-grey/30"} ${g?"opacity-75 cursor-not-allowed":""}`,children:g?s.jsx("i",{className:"fi fi-rr-loading fi-spin text-xl"}):s.jsx("i",{className:`fi ${(null==v?void 0:v.isLikedByUser)?"fi-sr-heart":"fi-rr-heart"} text-xl transition-transform`})}),s.jsx("p",{className:"text-xl text-dark-grey",children:(null==v?void 0:v.total_likes)||0}),s.jsx("button",{onClick:()=>{m(e=>!e)},className:"w-10 h-10 rounded-full flex items-center justify-center bg-grey/20 hover:bg-grey/30 text-dark-grey transition-colors ml-2","aria-label":"View comments",children:s.jsx("i",{className:"fi fi-rr-comment-dots text-xl"})}),s.jsx("p",{className:"text-xl text-dark-grey",children:w})]}),s.jsxs("div",{className:"flex gap-4 items-center",children:[n===k&&!o&&s.jsxs(a,{to:`/editor/${b}`,className:"bg-black text-white px-4 py-2 rounded-full hover:bg-grey/90 transition-colors flex items-center gap-2","aria-label":"Edit post",children:[s.jsx("span",{children:"Edit"}),s.jsx("i",{className:"fi fi-rr-pencil text-sm"})]}),s.jsxs("div",{className:"relative group",children:[s.jsx("button",{onClick:()=>u(!x),className:"w-10 h-10 rounded-full flex items-center justify-center bg-grey/20 hover:bg-grey/30 text-dark-grey transition-colors","aria-label":"Share options",children:s.jsx("i",{className:"fi fi-sr-share text-lg"})}),x&&s.jsx("div",{className:`absolute ${o?"bottom-full right-0 mb-4":"right-0 bottom-full mb-2"} w-44 bg-white dark:bg-gray-800 border border-grey/20 dark:border-gray-700 shadow-lg rounded-xl z-10 animate-fade-in`,children:s.jsxs("ul",{className:"p-2 flex justify-around",children:[[{icon:"facebook",color:"#1877F2",url:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(p)}`},{icon:"twitter",color:"#1DA1F2",url:`https://x.com/intent/tweet?text=${encodeURIComponent(`Read "${y}" - ${p}`)}`},{icon:"whatsapp",color:"#25D366",url:`https://api.whatsapp.com/send?text=${encodeURIComponent(`Read "${y}" - ${p}`)}`}].map((e,t)=>s.jsx("li",{children:s.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"block p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",style:{color:e.color},children:s.jsx("i",{className:`fi fi-brands-${e.icon} text-xl`})})},t)),s.jsx("li",{children:s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(p),l.success("Link copied to clipboard!")},className:"block p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-gray-600 dark:text-gray-300",title:"Copy Link",children:s.jsx("i",{className:"fi fi-rr-copy-alt text-xl"})})})]})})]})]})]})]})},C=({url:e,caption:t})=>s.jsxs("div",{className:"my-8 flex flex-col items-center",children:[s.jsx("img",{src:e,alt:"Post_Image",className:"w-full max-w-4xl max-h-[500px] object-contain rounded-2xl shadow-2xl"}),t&&t.length>0&&s.jsx("p",{className:"mt-4 text-center text-2xl text-gray-600 italic",children:t})]}),L=({code:t})=>{const[a,r]=e.useState(!1);return s.jsxs("div",{className:"relative my-8",children:[s.jsx("pre",{className:"bg-black text-white p-4 rounded-2xl overflow-x-auto font-mono text-base shadow-lg",children:s.jsx("code",{children:t})}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t).then(()=>{r(!0),setTimeout(()=>r(!1),2e3)}).catch(e=>{})},className:"absolute top-3 right-3 bg-gray-200 hover:bg-gray-300 text-xs text-gray-700 py-1 px-3 rounded shadow",children:a?"Copied!":"Copy"})]})},S=({data:t})=>{const[a,r]=e.useState(!1);return s.jsxs("div",{className:"relative my-8 max-w-xl mx-auto border rounded-2xl p-8 bg-gradient-to-br from-blue-50 to-blue-100 shadow-2xl",children:[t.meta&&t.meta.image&&t.meta.image.url&&s.jsx("img",{src:t.meta.image.url,alt:t.meta.title||"Link preview",className:"w-full h-64 object-contain rounded-lg mb-6"}),s.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"block text-blue-700 hover:text-blue-800 text-2xl  mb-4",children:t.meta&&t.meta.title?t.meta.title:t.link}),t.meta&&t.meta.description&&s.jsx("p",{className:"mt-4 text-blue-800 text-xl",dangerouslySetInnerHTML:{__html:t.meta.description}}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t.link).then(()=>{r(!0),setTimeout(()=>r(!1),2e3)}).catch(e=>{})},className:"absolute top-3 right-3 bg-gray-200 hover:bg-gray-300 text-xs text-gray-700 py-1 px-3 rounded shadow",children:a?"Copied!":"Copy Link"})]})},M=({data:e})=>s.jsx("div",{className:"my-8",children:s.jsx("div",{className:"aspect-video w-full",children:s.jsx("iframe",{width:"100%",height:"100%",src:`https://www.youtube.com/embed/${$(e.url)}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"rounded-xl shadow-lg"})})}),$=e=>{const t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return t&&11===t[2].length?t[2]:null},E=({block:e})=>{const{type:t,data:a}=e;switch(t){case"paragraph":return s.jsx("p",{className:"my-6 text-xl leading-relaxed text-gray-800",dangerouslySetInnerHTML:{__html:a.text}});case"header":return 1===a.level?s.jsx("h1",{className:"my-8 text-5xl font-extrabold text-gray-900",dangerouslySetInnerHTML:{__html:a.text}}):2===a.level?s.jsx("h2",{className:"my-7 text-4xl font-bold text-gray-900",dangerouslySetInnerHTML:{__html:a.text}}):3===a.level?s.jsx("h3",{className:"my-6 text-3xl font-semibold text-gray-900",dangerouslySetInnerHTML:{__html:a.text}}):null;case"image":return s.jsx(C,{url:a.file.url,caption:a.caption||""});case"code":return s.jsx(L,{code:a.code});case"table":return s.jsx("div",{className:"my-8 overflow-x-auto",children:s.jsx("table",{className:"min-w-full border-collapse border border-gray-300 shadow-lg",children:s.jsx("tbody",{className:"bg-white",children:a.content.map((e,t)=>s.jsx("tr",{className:"divide-x divide-gray-200",children:e.map((e,t)=>s.jsx("td",{className:"px-4 py-2 border border-gray-300 text-gray-700 text-lg",dangerouslySetInnerHTML:{__html:e}},t))},t))})})});case"quote":return s.jsxs("blockquote",{className:"my-8 border-l-4 border-gray-400 pl-8 italic text-gray-600 text-2xl",children:[s.jsx("p",{dangerouslySetInnerHTML:{__html:a.text}}),a.author&&s.jsxs("footer",{className:"mt-2 text-right text-xl font-medium text-gray-600",children:["â€” ",a.author]})]});case"list":return"ordered"===a.style?s.jsx("ol",{className:"my-8 list-decimal list-inside text-gray-800 text-xl",children:a.items.map((e,t)=>s.jsx("li",{className:"my-3",dangerouslySetInnerHTML:{__html:e}},t))}):s.jsx("ul",{className:"my-8 list-disc list-inside text-gray-800 text-xl",children:a.items.map((e,t)=>s.jsx("li",{className:"my-3",dangerouslySetInnerHTML:{__html:e}},t))});case"delimiter":return s.jsx("hr",{className:"my-8 border-t-2 border-gray-200"});case"checklist":return s.jsx("ul",{className:"my-8",children:a.items.map((e,t)=>s.jsxs("li",{className:"flex items-center space-x-4 my-3",children:[s.jsx("input",{type:"checkbox",checked:e.checked,readOnly:!0,className:"form-checkbox h-6 w-6 text-blue-600"}),s.jsx("span",{className:"text-gray-800 text-xl",dangerouslySetInnerHTML:{__html:e.text}})]},t))});case"warning":return s.jsxs("div",{className:"my-8 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-6 rounded-xl shadow-lg",role:"alert",children:[a.title&&s.jsx("p",{className:"font-bold text-2xl",children:a.title}),a.message&&s.jsx("p",{className:"mt-3 text-xl",dangerouslySetInnerHTML:{__html:a.message}})]});case"linkTool":return s.jsx(S,{data:a});case"youtubeEmbed":return s.jsx(M,{data:a});default:return s.jsxs("div",{className:"my-8 text-orange-500",children:["Unsupported block type: ",t]})}},R=250,T=()=>s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})}),B=()=>s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),z=()=>s.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),D=o.memo(({action:a,replyingTo:l=null,onPost:o,initialText:d="",autoFocus:c=!1,onCancel:m})=>{const[x,u]=e.useState(d),[g,h]=e.useState(!1),[p,y]=e.useState(d.length||0),[b,f]=e.useState(!1),{blog:v}=e.useContext(te)||{},{userAuth:j}=e.useContext(t),{username:w,profile_img:k,fullname:N}=j||{},_=e.useRef(null);e.useEffect(()=>{u(d),y(d.length||0)},[d]),e.useEffect(()=>{c&&_.current&&_.current.focus()},[c]);const C=e.useCallback(e=>{const t=e.target.value;t.length<=R&&(u(t),y(t.length))},[]),L=e.useCallback(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),S())},[x]),S=e.useCallback(async()=>{var e,t,s;if(!w)return void i.error(`Please login to ${a.toLowerCase()}`);const l=n.sanitize(x.trim());if(!l)return void i.error(`Please write something to ${a.toLowerCase()}`);h(!0);const d=i.loading(("Save"===a?"Saving":"Posting")+"...");try{if("Save"===a||"Reply"===a)await o(l),u(""),"Save"===a&&m&&m();else if("Comment"===a){if(!(null==v?void 0:v._id))throw new Error("Blog data is not available.");const{data:t}=await r.post("/add-comment",{blog_id:v._id,blog_author:v.authorId._id,comment:l});u(""),y(0);let s=t.comment&&"object"==typeof t.comment?t.comment:t;s={...s,commented_by:(null==(e=s.commented_by)?void 0:e.personal_info)?s.commented_by:{personal_info:{username:j.username,profile_img:j.profile_img,fullname:j.fullname},_id:j._id||s.commented_by},commentedAt:s.commentedAt||(new Date).toISOString(),_id:s._id||`temp-${Date.now()}`},o&&o(s)}i.success(`${a}ed successfully!`,{id:d})}catch(c){const e=(null==(s=null==(t=c.response)?void 0:t.data)?void 0:s.error)||"ECONNABORTED"===c.code?"Request timeout.":`Failed to ${a.toLowerCase()}`;i.error(e,{id:d})}finally{h(!1)}},[a,v,x,o,m,w]),M=l?"Write your reply...":"Save"===a?"Edit your comment...":`Share your thoughts${w?`, ${w.split(" ")[0]}`:""}...`;return s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("img",{src:k||"/default-avatar.png",alt:"",className:"w-10 h-10 rounded-lg object-cover border border-gray-200 dark:border-gray-600",loading:"lazy",decoding:"async",onError:e=>{e.target.src="/default-avatar.png",e.target.onerror=null}})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"relative rounded-lg transition-colors duration-200 "+(b?"bg-white dark:bg-gray-800 ring-2 ring-blue-500/20 shadow-sm":"bg-gray-50 dark:bg-gray-800/50"),children:[s.jsx("textarea",{ref:_,value:x,onChange:C,onKeyDown:L,onFocus:()=>f(!0),onBlur:()=>f(!1),placeholder:M,disabled:g,autoFocus:c,className:"w-full p-3 pr-20 bg-transparent border-0 rounded-lg resize-none placeholder-gray-500 dark:placeholder-gray-400 text-gray-800 dark:text-gray-200 focus:outline-none text-sm leading-relaxed transition-colors",rows:"3",maxLength:R,"aria-label":l?"Reply comment field":"Comment field"}),p>175&&s.jsx("div",{className:"absolute right-3 top-3",children:s.jsxs("div",{className:"text-xs font-medium px-2 py-1 rounded "+(p>225?"text-primary-500 bg-primary-500/10":"text-gray-500 bg-gray-500/10"),children:[p,"/",R]})})]}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsx("div",{children:m&&s.jsx("button",{onClick:m,className:"px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",disabled:g,children:"Cancel"})}),s.jsx("button",{onClick:S,disabled:g||!x.trim(),className:"px-4 py-1.5 rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 "+(g||!x.trim()?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white shadow-sm hover:shadow"),children:g?s.jsxs(s.Fragment,{children:[s.jsx(z,{}),"Save"===a?"Saving...":"Posting..."]}):s.jsxs(s.Fragment,{children:["Save"===a?s.jsx(B,{}):s.jsx(T,{}),a]})})]})]})]})})});D.propTypes={action:d.string.isRequired,replyingTo:d.string,onPost:d.func,initialText:d.string,autoFocus:d.bool,onCancel:d.func},D.displayName="CommentField";const P=({filled:e=!1,className:t="w-4 h-4"})=>s.jsx("svg",{className:t,fill:e?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),A=({className:e="w-4 h-4"})=>s.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),F=({className:e="w-4 h-4"})=>s.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),I=({className:e="w-4 h-4"})=>s.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),U=({className:e="w-4 h-4"})=>s.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),H=({className:e="w-3 h-3"})=>s.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),W=({className:e="w-3 h-3"})=>s.jsx("svg",{className:e,fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}),q=({className:e="w-4 h-4"})=>s.jsxs("svg",{className:`animate-spin ${e}`,fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),V=o.memo(({commentData:a,depth:l=0})=>{const[o,n]=e.useState(a),[d,u]=e.useState(a.isLiked),[g,h]=e.useState(a.upvotesCount),[p,y]=e.useState(!1),[b,f]=e.useState(!1),[v,j]=e.useState(!1),[w,k]=e.useState([]),[N,_]=e.useState(!1),[C,L]=e.useState(!1),[S,M]=e.useState(0),[$,E]=e.useState(!1),R=e.useRef(null);var T,B;T=R,B=()=>E(!1),e.useEffect(()=>{const e=e=>{T.current&&!T.current.contains(e.target)&&B()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[T,B]);const{_id:z,blog_id:O,blog_author:K,comment:G,commentedAt:J,commented_by:Y,isDeleted:Q,repliesCount:X,edited:Z}=o,{personal_info:{fullname:ee,profile_img:te,username:se,isVerified:ae}={}}=Y||{},{userAuth:re}=e.useContext(t),{access_token:le,_id:oe}=re||{},{socket:ie}=c(),ne=e.useMemo(()=>oe===(null==Y?void 0:Y._id),[oe,null==Y?void 0:Y._id]),de=e.useMemo(()=>oe===K,[oe,K]),ce=e.useMemo(()=>ne||de,[ne,de]);e.useEffect(()=>{if(!ie||!z)return;const e={commentLiked:e=>{e._id===z&&(h(e.upvotesCount),e.userId===oe&&u(e.isLiked))},commentUpdated:e=>{e._id===z&&n(t=>({...t,comment:e.comment,edited:e.edited,editedAt:e.editedAt}))},newReply:e=>{e.parent===z&&v&&k(t=>[e,...t]),e.parent===z&&n(e=>({...e,repliesCount:(e.repliesCount||0)+1}))},commentDeleted:e=>{e._id===z&&n(e=>({...e,isDeleted:!0,comment:"[deleted]",commented_by:null}))}};return Object.entries(e).forEach(([e,t])=>{ie.on(e,t)}),()=>{Object.entries(e).forEach(([e,t])=>{ie.off(e,t)})}},[ie,z,oe,v]);const me=e.useCallback(()=>{le?y(e=>!e):i.error("Please login to reply")},[le]),xe=e.useCallback(async e=>{var t,s;if(!le)return void i.error("Please login to reply");const a={_id:`temp-${Date.now()}`,blog_id:O,blog_author:K,comment:e,commented_by:{personal_info:{...re}},commentedAt:(new Date).toISOString(),isReply:!0,parent:z,upvotes:[],upvotesCount:0,isLiked:!1};k(e=>[a,...e]),y(!1);try{const{data:t}=await r.post("/reply-comment",{blog_id:O,blog_author:K,comment:e,parent_comment_id:z});k(e=>e.map(e=>e._id===a._id?t:e)),i.success("Reply posted!")}catch(l){k(e=>e.filter(e=>!e._id.startsWith("temp-"))),i.error((null==(s=null==(t=l.response)?void 0:t.data)?void 0:s.error)||"Failed to post reply")}},[z,le,O,K,re]),ue=e.useCallback(async()=>{if(!N){_(!0);try{const{data:e}=await r.get(`/get-comment-replies/${z}`,{params:{skip:5*S,limit:5,user_id:oe}});e.length<5&&L(!0),k(t=>[...t,...e]),M(e=>e+1)}catch(e){i.error("Failed to load replies.")}finally{_(!1)}}},[z,S,oe,N,5]),ge=e.useCallback(()=>{!v&&0===w.length&&X>0&&ue(),j(e=>!e)},[v,w.length,X,ue]),he=e.useCallback(async()=>{if(!le)return void i.error("Please login to like");const e=!d;u(e),h(t=>e?t+1:t-1);try{await r.post("/like-comment",{comment_id:z})}catch(t){u(!e),h(t=>e?t-1:t+1),i.error("Like failed. Please try again.")}},[z,le,d]),pe=e.useCallback(async e=>{var t,s;if(le)try{await r.patch(`/edit-comment/${z}`,{comment:e}),f(!1),i.success("Comment updated!")}catch(a){throw i.error((null==(s=null==(t=a.response)?void 0:t.data)?void 0:s.error)||"Failed to edit"),a}else i.error("Please login to edit")},[z,le]),ye=e.useCallback(async()=>{var e,t;if(!le)return void i.error("Please login to delete");if(E(!1),!window.confirm("Are you sure you want to delete this comment?"))return;const s=i.loading("Deleting...");try{await r.delete(`/delete-comment/${z}`),i.success("Comment deleted",{id:s})}catch(a){i.error((null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.error)||"Failed to delete",{id:s})}},[z,le]);return l>5?null:Q?s.jsx("div",{className:"mb-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg text-center",children:s.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-400 dark:text-gray-500 text-sm",children:[s.jsx(U,{className:"w-4 h-4"}),"This comment has been deleted"]})}):s.jsx("div",{className:"mb-3 "+(l>0?"ml-3 pl-3 border-l border-gray-200 dark:border-gray-600":""),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("img",{src:te||"/default-avatar.png",alt:"",className:"w-8 h-8 rounded-lg object-cover border border-gray-200 dark:border-gray-600",loading:"lazy",decoding:"async",onError:e=>{e.target.src="/default-avatar.png",e.target.onerror=null}})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[b?s.jsx(D,{action:"Save",initialText:G,onPost:pe,onCancel:()=>f(!1),autoFocus:!0}):s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-100 dark:border-gray-700 shadow-sm",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"font-medium text-gray-900 dark:text-white text-sm truncate",children:[ee||"Anonymous",ae&&s.jsx(m,{size:12})]}),se&&s.jsxs("span",{className:"text-gray-500 dark:text-gray-400 text-xs truncate",children:["@",se]}),s.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs",children:x(J)||"Just now"}),Z&&s.jsxs("span",{className:"text-blue-500 dark:text-blue-400 text-xs flex items-center gap-1",children:[s.jsx(I,{className:"w-3 h-3"}),"edited"]})]})}),ce&&s.jsxs("div",{className:"relative",ref:R,children:[s.jsx("button",{onClick:()=>E(e=>!e),className:"p-1 rounded text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Comment actions",children:s.jsx(F,{})}),$&&s.jsxs("div",{className:"absolute top-full right-0 z-10 w-36 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-1",children:[ne&&s.jsxs("button",{onClick:()=>{f(!0),E(!1)},className:"w-full text-left flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700",children:[s.jsx(I,{className:"w-4 h-4"}),"Edit"]}),s.jsxs("button",{onClick:ye,className:"w-full text-left flex items-center gap-2 px-3 py-2 text-sm text-orange-500 hover:bg-red-50 dark:hover:bg-red-900/20",children:[s.jsx(U,{className:"w-4 h-4"}),"Delete"]})]})]})]}),s.jsx("p",{className:"text-gray-800 dark:text-gray-200 text-sm mb-3 leading-relaxed",children:G}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("button",{onClick:he,disabled:!le,className:`flex items-center gap-1 text-sm transition-colors ${d?"text-orange-500":"text-gray-500 dark:text-gray-400 hover:text-orange-500 dark:hover:text-red-400"} ${le?"":"opacity-50 cursor-not-allowed"}`,children:[s.jsx(P,{filled:d}),s.jsx("span",{children:g||0})]}),s.jsxs("button",{onClick:me,disabled:!le,className:"flex items-center gap-1 text-sm transition-colors "+(le?"text-gray-500 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400":"opacity-50 cursor-not-allowed text-gray-400"),children:[s.jsx(A,{}),s.jsx("span",{children:"Reply"})]})]})]}),p&&s.jsx("div",{className:"mt-3",children:s.jsx(D,{action:"Reply",replyingTo:z,onPost:xe,autoFocus:!0,onCancel:()=>y(!1)})}),X>0&&s.jsx("div",{className:"mt-3",children:v?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:ge,className:"flex items-center gap-2 text-blue-500 dark:text-blue-400 hover:text-blue-600 dark:hover:text-blue-300 text-sm font-medium mb-2",children:[s.jsx(W,{}),"Hide replies"]}),s.jsx("div",{className:"space-y-3",children:w.map(e=>s.jsx(V,{commentData:e,depth:l+1},e._id))}),!C&&X>w.length&&s.jsx("button",{onClick:ue,disabled:N,className:"flex items-center gap-2 mt-2 text-sm "+(N?"text-gray-400":"text-blue-500 dark:text-blue-400 hover:text-blue-600 dark:hover:text-blue-300"),children:N?s.jsxs(s.Fragment,{children:[s.jsx(q,{}),"Loading..."]}):`Load ${X-w.length} more`})]}):s.jsxs("button",{onClick:ge,className:"flex items-center gap-2 text-blue-500 dark:text-blue-400 hover:text-blue-600 dark:hover:text-blue-300 text-sm font-medium",children:[s.jsx(H,{}),`View ${X} ${X>1?"replies":"reply"}`]})})]})]})})});V.propTypes={commentData:d.object.isRequired,depth:d.number},V.displayName="CommentCard";const O=(t,s,a)=>{const[l,o]=e.useState({comments:[],loading:!1,error:null,page:0,hasMore:!0,totalCount:0}),i=e.useCallback(async(e=0,l=!1)=>{if(t){o(e=>({...e,loading:!0,error:null}));try{const i=await(async(e,t=0,s=5,a=null)=>{var l,o;try{if(!e||"string"!=typeof e)throw new Error("Invalid blogId provided");const o={blog_id:e,skip:t*s,limit:s,user_id:a,timestamp:Date.now()},i=await r.post("/get-post-comments",o,{timeout:1e4,validateStatus:e=>e<500});if(200!==i.status)throw new Error((null==(l=i.data)?void 0:l.error)||`Request failed with status ${i.status}`);return{comments:Array.isArray(i.data.comments)?i.data.comments.map(e=>({...e,isLiked:e.isLiked||!1})):[],total:Number(i.data.total)||0,hasMore:!1!==i.data.hasMore,page:Number(i.data.page)||t}}catch(i){if(401===(null==(o=i.response)?void 0:o.status))throw new Error("Please login to view comments");if("ECONNABORTED"===i.code)throw new Error("Request timeout. Please try again.");throw i}})(t,e,5,a);o(t=>({comments:l?i.comments:[...t.comments,...i.comments],loading:!1,page:e+1,hasMore:i.hasMore,totalCount:i.total,error:null})),l&&s&&s(e=>({...e,total_comments:i.total,total_parent_comments:i.total}))}catch(i){o(e=>({...e,loading:!1,error:i.message||"Failed to load comments"}))}}},[t,s,a,5]),n=e.useCallback(e=>{o(e)},[]);return e.useEffect(()=>{t&&i(0,!0)},[t,i]),{...l,fetchComments:i,setCommentsState:n}},K=()=>s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),G=()=>s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),J=()=>s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Y=o.memo(()=>{const{blog:a,commentsWrapper:r,setCommentsWrapper:l,updateBlogActivity:o}=e.useContext(te),{userAuth:i}=e.useContext(t),{_id:n}=i||{},{socket:d}=c(),m=null==a?void 0:a._id,x=(null==a?void 0:a.title)||"",{comments:b,loading:f,error:v,page:j,hasMore:w,totalCount:k,fetchComments:_,setCommentsState:C}=O(m,o,n);e.useEffect(()=>{d&&m&&(d.emit("joinCommentRoom",{blog_id:m}),d.emit("joinPostRoom",{blog_id:m}))},[d,m]),e.useEffect(()=>{if(!d||!m)return;const e=e=>{e.blog_id!==m||e.isReply||C(t=>t.comments.some(t=>t._id===e._id)?t:{...t,comments:[e,...t.comments],totalCount:t.totalCount+1})},t=e=>{e.blog_id===m&&e.parent&&C(t=>({...t,comments:t.comments.map(t=>t._id===e.parent?{...t,repliesCount:(t.repliesCount||0)+1}:t),totalCount:t.totalCount+1}))},s=e=>{e.blog_id===m&&C(t=>{const s=t.comments.some(t=>t._id===e._id);return{...t,comments:t.comments.map(t=>t._id===e._id?{...t,isDeleted:!0,comment:"[deleted]",commented_by:null}:t._id===e.parent?{...t,repliesCount:Math.max(0,(t.repliesCount||1)-1)}:t),totalCount:Math.max(0,t.totalCount-1),total_parent_comments:s?Math.max(0,t.totalCount-1):t.totalCount}})};return d.on("newComment",e),d.on("newReply",t),d.on("commentDeleted",s),()=>{d.off("newComment",e),d.off("newReply",t),d.off("commentDeleted",s)}},[d,m,C]);const L=e.useCallback(e=>{C(t=>t.comments.some(t=>t._id===e._id)?t:{...t,comments:[e,...t.comments],totalCount:t.totalCount+1})},[C]),{ref:S,inView:M}=N({threshold:0,triggerOnce:!1}),$=e.useCallback(()=>{!f&&w&&_(j)},[_,f,w,j]);e.useEffect(()=>{M&&$()},[M,$]);const E=e.useMemo(()=>s.jsx("div",{className:"sticky top-0 z-10 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-500 rounded-lg text-white",children:s.jsx(G,{})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"font-semibold text-gray-900 dark:text-white",children:["Comments (",k,")"]}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate max-w-[200px]",children:x})]})]}),s.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Close comments",children:s.jsx(K,{})})]})}),[k,x,l]);return s.jsx(u,{children:r&&s.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex justify-end bg-black/50 backdrop-blur-sm",onClick:()=>l(!1),children:s.jsxs(g.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"w-full max-w-md h-full bg-white dark:bg-gray-900 shadow-2xl flex flex-col",onClick:e=>e.stopPropagation(),children:[E,s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:s.jsxs("div",{className:"p-4 space-y-6",children:[s.jsx(D,{action:"Comment",onPost:L}),v&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center text-orange-500",children:[s.jsx(J,{}),s.jsx("p",{className:"mt-2 text-sm",children:v}),s.jsx("button",{onClick:()=>_(0,!0),className:"mt-3 text-xs font-medium underline hover:text-red-600",children:"Try Again"})]}),s.jsx("div",{className:"space-y-4",children:b.map(e=>s.jsx(h,{children:s.jsx(V,{index:0,leftVal:0,commentData:e})},e._id))}),f&&s.jsx("div",{className:"flex justify-center py-4",children:s.jsx(p,{})}),!f&&!w&&b.length>0&&s.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"End of comments"}),!f&&0===b.length&&!v&&s.jsx(y,{message:"No comments yet. Be the first to share your thoughts!"}),s.jsx("div",{ref:S,className:"h-4"})]})})]})})})}),Q=({className:e})=>s.jsx("div",{className:`bg-gray-200 dark:bg-gray-700 rounded-md animate-pulse ${e}`}),X=()=>s.jsxs("div",{className:"max-w-[900px] center py-10 max-lg:px-[5vw]",children:[s.jsx(Q,{className:"aspect-video w-full"}),s.jsx(Q,{className:"h-12 w-3/4 mt-12"}),s.jsx(Q,{className:"h-12 w-1/2 mt-4"}),s.jsxs("div",{className:"flex flex-wrap justify-between items-center my-8 gap-4",children:[s.jsxs("div",{className:"flex items-center gap-5",children:[s.jsx(Q,{className:"w-12 h-12 rounded-full"}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx(Q,{className:"h-5 w-32"}),s.jsx(Q,{className:"h-4 w-24"})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Q,{className:"h-5 w-24"}),s.jsx(Q,{className:"h-5 w-20"})]})]}),s.jsx("hr",{className:"border-dark-grey/50 my-3"}),s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("div",{className:"flex gap-3 items-center",children:[s.jsx(Q,{className:"w-10 h-10 rounded-full"}),s.jsx(Q,{className:"h-6 w-8"}),s.jsx(Q,{className:"w-10 h-10 rounded-full"}),s.jsx(Q,{className:"h-6 w-8"})]}),s.jsx("div",{className:"flex gap-4 items-center",children:s.jsx(Q,{className:"w-10 h-10 rounded-full"})})]}),s.jsx("hr",{className:"border-dark-grey/50 my-3"}),s.jsxs("div",{className:"my-12 flex flex-col gap-4",children:[s.jsx(Q,{className:"h-6 w-full"}),s.jsx(Q,{className:"h-6 w-full"}),s.jsx(Q,{className:"h-6 w-11/12"}),s.jsx("br",{}),s.jsx(Q,{className:"h-6 w-full"}),s.jsx(Q,{className:"h-6 w-10/12"}),s.jsx("br",{}),s.jsx(Q,{className:"h-48 w-full"})," ",s.jsx("br",{}),s.jsx(Q,{className:"h-6 w-full"}),s.jsx(Q,{className:"h-6 w-11/12"})]})]});class Z extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?s.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gray-50 dark:bg-gray-900",children:s.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 text-center",children:[s.jsx("div",{className:"text-6xl mb-4",children:"ðŸ˜ž"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white mb-2",children:"Something went wrong"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"We're sorry for the inconvenience. Please try refreshing the page or return to the homepage."}),!1,s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[s.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors",children:"Refresh Page"}),s.jsx(a,{to:"/",className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-center",children:"Go to Homepage"})]})]})}):this.props.children}}const ee=({src:t,placeholder:a,alt:r,className:l="",style:o={},transitionDuration:i=.3,blurAmount:n="8px"})=>{const[d,c]=e.useState(!1),[m,x]=e.useState(a);return e.useEffect(()=>{const e=new Image;return e.src=t,e.onload=()=>{x(t),c(!0)},e.onerror=()=>{x(a||"/placeholder-image.jpg"),c(!0)},()=>{e.onload=null,e.onerror=null}},[t,a]),s.jsxs("div",{className:`relative overflow-hidden ${l}`,style:o,children:[s.jsx("img",{src:a,alt:r,className:"absolute inset-0 w-full h-full object-cover transition-opacity duration-500 "+(d?"opacity-0":"opacity-100"),style:{filter:`blur(${n})`,transform:"scale(1.1)"}}),s.jsx(g.img,{src:m,alt:r,className:"w-full h-full object-cover",initial:{opacity:0},animate:{opacity:d?1:0},transition:{duration:i},loading:"lazy"}),!d&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})})]})},te=e.createContext({}),se=o.memo(()=>{var t,l,o,i;const{blog_id:n}=b(),d=f(),{socket:x}=c(),[u,g]=e.useState({title:"",des:"",content:[],banner:"",authorId:{},tags:[],activity:{},publishedAt:"",readingTime:5}),[p,y]=e.useState([]),[N,C]=e.useState(!0),[L,S]=e.useState(null),[M,$]=e.useState(!1),{title:R,des:T,content:B,banner:z,authorId:{personal_info:{fullname:D,username:P,profile_img:A,isVerified:F}={}}={},publishedAt:I,tags:U=[],readingTime:H}=u,W=e.useCallback(async()=>{var e,t,s,a;try{C(!0),S(null);const{data:{blog:t}}=await r.post("/get-post",{blog_id:n}),[s,a]=await Promise.allSettled([v(t._id),(null==(e=t.tags)?void 0:e.length)?r.post("/similar/posts",{tag:t.tags[0],blog_id:n}):Promise.resolve({data:[]})]),l="fulfilled"===s.status?s.value.comments:[],o="fulfilled"===s.status?s.value.total:0;g({...t,comments:l,activity:{...t.activity,total_comments:o,total_parent_comments:o,isLikedByUser:t.activity.isLikedByUser||!1}}),"fulfilled"===a.status&&a.value.data&&y(a.value.data)}catch(l){const e=(null==(s=null==(t=l.response)?void 0:t.data)?void 0:s.error)||l.message||"Failed to load blog post";S(e),404===(null==(a=l.response)?void 0:a.status)&&d("/404",{replace:!0})}finally{C(!1)}},[n,d]),q=e.useCallback(e=>{g(t=>({...t,activity:{...t.activity,...e}}))},[]);e.useEffect(()=>{W()},[W]),e.useEffect(()=>{if(!x||!n)return;x.emit("joinPostRoom",{blog_id:n});const e=e=>{e.blog_id===n&&q({total_likes:e.total_likes})},t=e=>{e.blog_id===n&&(toast.error("This post has been deleted by the author."),d("/"))},s=e=>{e.blog_id===n&&q({total_comments:(u.activity.total_comments||0)+1,total_parent_comments:(u.activity.total_parent_comments||0)+1})},a=e=>{e.blog_id===n&&q({total_comments:(u.activity.total_comments||0)+1})},r=e=>{e.blog_id===n&&q({total_comments:Math.max(0,(u.activity.total_comments||1)-1),total_parent_comments:e.isReply?u.activity.total_parent_comments:Math.max(0,(u.activity.total_parent_comments||1)-1)})};return x.on("likeUpdate",e),x.on("postDeleted",t),x.on("newComment",s),x.on("newReply",a),x.on("commentDeleted",r),()=>{x.off("likeUpdate",e),x.off("postDeleted",t),x.off("newComment",s),x.off("newReply",a),x.off("commentDeleted",r)}},[x,n,q,d,u.activity]);const[V,O]=e.useState(0);return e.useEffect(()=>{const e=()=>{const e=window.scrollY,t=document.body.scrollHeight-window.innerHeight;t&&O(100*Number((e/t).toFixed(2)))};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),N?s.jsx(X,{}):L?s.jsx("div",{className:"max-w-[900px] center py-10 max-lg:px-[5vw]",children:s.jsx(j,{message:L,onRetry:W})}):s.jsxs(Z,{children:[s.jsx(w,{title:R,description:T||`${R} - A post by ${D}`,image:z,type:"article",schema:{"@context":"https://schema.org","@type":"BlogPosting",headline:R,description:T,image:z,author:{"@type":"Person",name:D},datePublished:I,timeRequired:`PT${H}M`,wordCount:(null==(l=null==(t=B[0])?void 0:t.blocks)?void 0:l.reduce((e,t)=>{var s,a;return e+((null==(a=null==(s=t.data)?void 0:s.text)?void 0:a.split(" ").length)||0)},0))||0}}),s.jsx("div",{className:"fixed top-0 left-0 w-full h-1 z-[60] bg-gray-200 dark:bg-gray-800",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-rose-500 transition-all duration-150",style:{width:`${V}%`}})}),s.jsx(h,{children:s.jsxs(te.Provider,{value:{blog:u,setBlog:g,updateBlogActivity:q,commentsWrapper:M,setCommentsWrapper:$},children:[s.jsx(k,{}),M&&s.jsx(Y,{}),s.jsxs("article",{className:"max-w-[900px] center py-10 max-lg:px-[5vw]",children:[s.jsxs("header",{className:"mb-12 relative",children:[s.jsx("div",{className:"relative aspect-video rounded-3xl overflow-hidden shadow-2xl mb-8 group",children:s.jsx(ee,{src:z,placeholder:"/placeholder-blog.jpg",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105",alt:R})}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("h1",{className:"text-3xl md:text-5xl font-extrabold leading-tight tracking-tight text-gray-900 dark:text-white",children:R}),s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 border-y border-gray-100 dark:border-gray-800 py-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{className:"w-14 h-14 rounded-full object-cover border-2 border-white dark:border-gray-900 shadow-sm ring-2 ring-gray-100 dark:ring-gray-800",src:A,alt:D,loading:"lazy"}),F&&s.jsx("div",{className:"absolute -bottom-1 -right-1 bg-white dark:bg-gray-900 rounded-full p-1 shadow-sm",children:s.jsx(m,{size:14})})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-bold capitalize text-lg text-gray-900 dark:text-gray-100 leading-none mb-1 flex items-center gap-2",children:[D,F&&s.jsx(m,{size:16})]}),s.jsxs(a,{className:"text-gray-500 dark:text-gray-400 hover:text-primary transition-colors text-sm font-medium",to:`/user/${P}`,children:["@",P]})]})]}),s.jsxs("div",{className:"flex items-center gap-6 text-sm font-medium text-gray-500 dark:text-gray-400",children:[s.jsxs("span",{className:"flex items-center gap-2 px-3 py-1 bg-gray-50 dark:bg-gray-800/50 rounded-full",children:[s.jsx("i",{className:"fi fi-rr-calendar text-base"}),(G=I,new Date(G).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}))]}),s.jsxs("span",{className:"flex items-center gap-2 px-3 py-1 bg-gray-50 dark:bg-gray-800/50 rounded-full",children:[s.jsx("i",{className:"fi fi-rr-time-fast text-base"}),(K=H||5,`${K} min read`)]})]})]})]}),s.jsx("div",{className:"mt-8 hidden md:block",children:s.jsx(_,{})})]}),s.jsx("section",{className:"font-gelasio blog-page-content prose prose-lg max-w-none dark:prose-invert \r\n                prose-headings:font-bold prose-headings:text-gray-900 dark:prose-headings:text-gray-100\r\n                prose-p:text-gray-700 dark:prose-p:text-gray-300 prose-p:leading-8\r\n                prose-a:text-primary hover:prose-a:text-primary-600 prose-a:no-underline hover:prose-a:underline\r\n                prose-img:rounded-2xl prose-img:shadow-lg prose-img:my-8\r\n                prose-blockquote:border-l-4 prose-blockquote:border-primary prose-blockquote:bg-gray-50 dark:prose-blockquote:bg-gray-800/30 prose-blockquote:py-2 prose-blockquote:not-italic\r\n                selection:bg-primary/20 selection:text-primary-900\r\n            ",children:null==(i=null==(o=B[0])?void 0:o.blocks)?void 0:i.map((e,t)=>s.jsx("div",{className:"my-2 transition-opacity duration-500",children:s.jsx(E,{block:e})},t))}),s.jsxs("footer",{className:"mt-20 border-t border-gray-100 dark:border-gray-800 pt-10",children:[s.jsx(_,{}),U.length>0&&s.jsxs("div",{className:"mt-10",children:[s.jsx("h3",{className:"text-sm font-bold uppercase tracking-wider text-gray-500 mb-4",children:"Filed Under"}),s.jsx("div",{className:"flex flex-wrap gap-3",children:U.map((e,t)=>s.jsxs(a,{to:`/search/tags/${e}`,className:"px-4 py-2 bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl text-sm font-medium text-gray-700 dark:text-gray-300 transition-all hover:-translate-y-0.5",children:["#",e]},t))})]}),p.length>0&&s.jsxs("div",{className:"mt-16",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsx("h3",{className:"text-2xl font-bold",children:"More like this"}),s.jsx(a,{to:"/",className:"text-primary text-sm font-medium hover:underline",children:"View all"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:p.map(e=>s.jsx("div",{className:"group cursor-pointer",children:s.jsxs(a,{to:`/post/${e.blog_id}`,className:"block",children:[s.jsx("div",{className:"relative aspect-[16/9] rounded-2xl overflow-hidden mb-4 bg-gray-100",children:s.jsx("img",{src:e.banner,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",alt:e.title,loading:"lazy"})}),s.jsx("h4",{className:"font-bold text-xl mb-2 group-hover:text-primary transition-colors line-clamp-2",children:e.title}),s.jsx("p",{className:"text-gray-500 text-sm line-clamp-2",children:e.des})]})},e._id))})]})]}),s.jsx("div",{className:"md:hidden fixed bottom-0 left-0 w-full bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border-t border-gray-200 dark:border-gray-800 p-4 z-40 animate-slide-up-fade",children:s.jsx(_,{small:!0})})]})]})})]});var K,G});export{se as default,te as postContext};
