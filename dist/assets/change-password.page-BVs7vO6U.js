import{r as s,U as e,j as r,d as a,F as t,z as o,a as n}from"./index-BK9O-y3K.js";import{I as d}from"./Input-C1SidNCc.js";const i=()=>{const i=s.useRef(),{userAuth:{access_token:c}}=s.useContext(e),[l,u]=s.useState(!1),p=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{6,20}$/;return r.jsxs(a,{children:[r.jsx(t,{}),r.jsxs("form",{ref:i,onSubmit:async s=>{s.preventDefault();const e=i.current,r=e.currentPassword.value.trim(),a=e.newPassword.value.trim();if(!r||!a)return o.error("Please fill in all the fields.");if(!p.test(r)||!p.test(a))return o.error("Password must be 6â€“20 chars, with at least one special char, one digit, one uppercase & one lowercase letter.");if(r===a)return o.error("New password must differ from the current one.");u(!0);const t=o.loading("Updating passwordâ€¦");try{const s=await n.post("/change-password",{currentPassword:r,newPassword:a},{headers:{"Content-Type":"application/json"},validateStatus:()=>!0});o.dismiss(t),s.status>=200&&s.status<300?(o.success(s.data.message),e.reset()):o.error(s.data.error||`Error ${s.status}: please try again.`)}catch(d){o.dismiss(t),o.error("Network error. Please check your connection.")}finally{u(!1)}},children:[r.jsx("h1",{className:"max-md:hidden",children:"Update Password"}),r.jsxs("div",{className:"py-10 w-full md:max-w-[400px] flex flex-col gap-5",children:[r.jsx(d,{name:"currentPassword",type:"password",className:"profile-edit-input",placeholder:"Current Password",icon:"fi-rr-unlock"}),r.jsx(d,{name:"newPassword",type:"password",className:"profile-edit-input",placeholder:"New Password",icon:"fi-rr-unlock"}),r.jsx("button",{type:"submit",className:"btn-dark px-10 "+(l?"opacity-50 cursor-not-allowed":""),disabled:l,children:l?"Updatingâ€¦":"Update Password"})]})]})]})};export{i as default};
