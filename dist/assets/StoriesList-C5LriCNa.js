import{j as e}from"./vendor-markdown-DVKDwQVh.js";import{i as s,u as t,r}from"./vendor-react-B32pNUrn.js";import{d as a,N as n,a as i,e as o}from"./index-D1ni5E-J.js";import{H as l,S as d}from"./Helmet-B6uE4TOi.js";import"./vendor-ui-BqXYh4xT.js";import"./vendor-socket-CUkmNz_4.js";const c=()=>e.jsx("div",{className:"w-full h-48 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}),g=(s,t=4)=>{const r=[];return s.forEach((s,a)=>{r.push(s),(a+1)%t===0&&r.push(e.jsx("div",{className:"col-span-full lg:col-span-4",children:e.jsx(o,{})},`ad-${a}`))}),r};function m(){const{pathname:o}=s(),m=t(),u=o.includes("trending"),x=u?"/trending-stories-pagination":"/stories-pagination-latest",h=u?"Trending Stories":"Latest Stories",[p,j]=r.useState([]),[b,y]=r.useState(null),[f,v]=r.useState(!0),[k,S]=r.useState(!0),w=r.useRef(),N=async(e=null)=>{S(!0);try{const{data:s}=await i.post(x,{limit:8,cursor:e});if(j(t=>e?[...t,...s.stories]:s.stories),v(s.hasMore),s.stories.length){const e=s.stories[s.stories.length-1];y(u?e.trendingScore:e.publishedAt)}}catch(s){}finally{S(!1)}};r.useEffect(()=>{j([]),y(null),v(!0),N()},[o]);const C=r.useCallback(e=>{k||(w.current&&w.current.disconnect(),w.current=new IntersectionObserver(e=>{e[0].isIntersecting&&f&&N(b)},{rootMargin:"200px"}),e&&w.current.observe(e))},[k,f,b]),L=({label:s,active:t,onClick:r})=>e.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium rounded-md transition-colors duration-300 "+(t?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-blue-100 dark:hover:bg-gray-700"),children:s});return e.jsxs(e.Fragment,{children:[e.jsxs(l,{children:[e.jsxs("title",{children:[h," | Shumse"]}),e.jsx("meta",{name:"description",content:`Stay updated with the ${h.toLowerCase()}. Fast, SEO-optimized.`})]}),e.jsx(a,{}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4",children:[e.jsxs("div",{className:"mb-6 flex justify-center space-x-4",children:[e.jsx(L,{label:"Latest",active:!u,onClick:()=>m("/stories")}),e.jsx(L,{label:"Trending",active:u,onClick:()=>m("/stories/trending")})]}),e.jsx("h1",{className:"text-3xl font-bold mb-6 text-gray-900 dark:text-gray-100",children:h}),!k&&0===p.length&&e.jsx(n,{pageType:"story"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:k&&0===p.length?Array(8).fill().map((s,t)=>e.jsx(c,{},t)):g(p.map((s,t)=>{const r=e.jsx(d,{story:s},s.story_id);return t===p.length-1?e.jsx("div",{ref:C,children:r},s.story_id):r}),4)}),!k&&f&&e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:()=>N(b),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition",children:"Load More"})})]})]})}export{m as default};
