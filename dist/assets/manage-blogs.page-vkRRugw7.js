import{a as e,r as t,U as s,j as a,F as r,L as l,f as o,z as d,g as i,d as n,I as c,e as x}from"./index-vd7Ycuse.js";import{F as g,a as u,b as m,c as b,d as h,e as p,f,g as y}from"./index-C0SflDH9.js";const j=e=>Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:1}).format(e),k=({blog:e,onEdit:d,onDelete:i})=>{const{banner:n,des:c,title:x,activity:{total_likes:f,total_comments:y,total_reads:k},blog_id:N,publishedAt:D}=e,[S,C]=t.useState(!1),{userAuth:{access_token:_}}=t.useContext(s);return a.jsxs("div",{className:"group bg-white dark:bg-[#212121] rounded-xl shadow-sm hover:shadow-xl border border-gray-100 dark:border-gray-800 overflow-hidden transition-all duration-300",children:[a.jsx(r,{}),a.jsxs("div",{className:"flex flex-col md:flex-row",children:[a.jsxs("div",{className:"w-full md:w-48 h-48 md:h-auto shrink-0 relative overflow-hidden",children:[a.jsx("img",{src:n,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110",loading:"lazy",alt:x}),a.jsx("div",{className:"absolute inset-0 bg-black/10 group-hover:bg-black/0 transition-colors duration-300"})]}),a.jsxs("div",{className:"flex-1 p-5 md:p-6 flex flex-col justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-start gap-4 mb-2",children:[a.jsx(l,{to:`/post/${N}`,className:"group-hover:text-amber-500 transition-colors duration-300",children:a.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white line-clamp-2 leading-snug",children:x})}),a.jsx("span",{className:"shrink-0 text-xs font-medium px-2 py-1 bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded-full",children:o(D)})]}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm line-clamp-2 mb-4 leading-relaxed",children:c})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mt-auto pt-4 border-t border-gray-100 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center space-x-4 text-gray-500 dark:text-gray-400 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(m,{className:"text-red-500"}),a.jsx("span",{children:j(f)})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(b,{className:"text-blue-500"}),a.jsx("span",{children:j(y)})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(h,{className:"text-gray-500"}),a.jsx("span",{children:j(k)})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(l,{to:`/editor/${N}`,className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",title:"Edit",children:a.jsx(g,{size:18})}),a.jsx("button",{onClick:t=>w(e,_,t.target),className:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-colors",title:"Delete",children:a.jsx(u,{size:18})}),a.jsx("button",{onClick:()=>{C(!S)},className:"p-2 rounded-full transition-colors "+(S?"bg-amber-100 text-amber-600 dark:bg-amber-900/30":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"),title:"Full Stats",children:a.jsx(p,{size:18})})]})]})]})]}),S&&a.jsx("div",{className:"bg-gray-50 dark:bg-[#2a2a2a] p-6 animate-fadeIn border-t border-gray-100 dark:border-gray-700",children:a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[a.jsx(v,{icon:a.jsx(h,{size:20}),label:"Reads",value:k,color:"indigo"}),a.jsx(v,{icon:a.jsx(m,{size:20}),label:"Likes",value:f,color:"pink"}),a.jsx(v,{icon:a.jsx(b,{size:20}),label:"Comments",value:y,color:"blue"})]})})]})},v=({icon:e,label:t,value:s,color:r})=>{const l={indigo:"text-indigo-600 bg-indigo-50 dark:bg-indigo-900/20 dark:text-indigo-400",pink:"text-pink-600 bg-pink-50 dark:bg-pink-900/20 dark:text-pink-400",blue:"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400"};return a.jsxs("div",{className:`p-4 rounded-xl flex items-center justify-between ${l[r]||l.indigo}`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium opacity-80 uppercase tracking-wider",children:t}),a.jsx("p",{className:"text-2xl font-bold mt-1",children:s.toLocaleString()})]}),a.jsx("div",{className:"p-2 bg-white/50 dark:bg-black/20 rounded-lg",children:e})]})},N=({blog:e})=>{let{des:o,title:d,blog_id:i,index:n}=e;const{userAuth:{access_token:c}}=t.useContext(s);return n++,a.jsxs("div",{className:"group flex items-start gap-4 md:gap-6 p-4 md:p-6 bg-white dark:bg-[#212121] rounded-xl border border-gray-200 dark:border-gray-800 hover:border-gray-300 dark:hover:border-gray-700 transition-all duration-300",children:[a.jsx(r,{}),a.jsx("span",{className:"flex-none text-4xl font-black text-gray-100 dark:text-gray-800 select-none group-hover:text-amber-500/10 transition-colors",children:n<10?"0"+n:n}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-start gap-4",children:[a.jsx("h2",{className:"text-lg md:text-xl font-bold text-gray-800 dark:text-gray-200 mb-2 truncate group-hover:text-amber-500 transition-colors",children:d}),a.jsx("span",{className:"px-2 py-1 text-[10px] uppercase font-bold tracking-wider text-amber-600 bg-amber-50 dark:text-amber-400 dark:bg-amber-900/20 rounded-md shrink-0",children:"Draft"})]}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm line-clamp-2 mb-4",children:(null==o?void 0:o.length)?o:"No Description Found"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs(l,{to:`/editor/${i}`,className:"flex items-center gap-2 text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-amber-600 dark:hover:text-amber-400 transition-colors",children:[a.jsx(g,{})," Edit"]}),a.jsxs("button",{onClick:t=>w(e,c,t.target),className:"flex items-center gap-2 text-sm font-medium text-red-500 hover:text-red-600 dark:hover:text-red-400 transition-colors",children:[a.jsx(u,{})," Delete"]})]})]})]})},w=(t,s,a)=>{const{index:r,blog_id:l,setStateFuc:o}=t,i=a.closest("button")||a;i.setAttribute("disabled","true"),i.classList.add("opacity-50","cursor-not-allowed");const n=d.loading("Deleting blog...");e.post("/delete-blog",{blog_id:l}).then(({data:e})=>{i.removeAttribute("disabled"),o(e=>{let{deletedDocCount:t,totalDocs:s,results:a}=e;const l=[...a];return l.splice(r,1),d.dismiss(n),d.success("Blog deleted successfully!"),l.length,t||(t=0),{...e,results:l,totalDocs:s-1,deleteDocCount:t+1}})}).catch(e=>{i.removeAttribute("disabled"),i.classList.remove("opacity-50","cursor-not-allowed"),d.dismiss(n),d.error("Failed to delete the blog.")})},D=()=>{const{userAuth:{access_token:o}}=t.useContext(s),d=i(),[x,g]=t.useState("Published"),[u,m]=t.useState(""),[b,h]=t.useState({Published:{results:[],page:1,totalDocs:0,deleteDocCount:0},Drafts:{results:[],page:1,totalDocs:0,deleteDocCount:0},Stories:{results:[],page:1,totalDocs:0,deleteDocCount:0}}),[p,j]=t.useState(!1),k=t.useCallback((e,t,s)=>{if("Stories"===e)return{route:"/get-user-stories",params:{page:s,query:t},isStory:!0};return{route:"/get-user-blogs",params:{page:s,draft:"Drafts"===e,query:t,deletedDocCount:b[e].deleteDocCount},isStory:!1}},[b]),v=t.useCallback(async({page:t=1,tab:s=x,query:a=u})=>{if(!o)return;j(!0);const{route:r,params:l,isStory:d}=k(s,a,t);try{const{data:i}=await e.post(r,l),n=d?i.stories||[]:i.blogs||[],c=d?"/get-user-stories-count":"/get-user-blogs-count",x=d?{query:a}:{draft:l.draft,query:a},g=await(async({state:t,arr_data:s,page:a,countRoute:r,data_to_send:l={},user:o})=>{let d;if(null!=t&&a>1){const e=new Set(t.results.map(e=>e._id)),r=s.filter(t=>!e.has(t._id));d={...t,results:[...t.results,...r],page:a}}else try{const{data:{totalDocs:t}}=await e.post(r,l);d={results:s,page:1,totalDocs:t}}catch(i){d={results:s,page:1,totalDocs:s.length}}return d})({state:b[s],arr_data:n,page:t,countRoute:c,data_to_send:x,user:o});h(e=>({...e,[s]:g}))}catch(i){}finally{j(!1)}},[o,x,u,k,b]);t.useEffect(()=>{o&&(""!==u?(h(e=>({...e,[x]:{...e[x],results:[],page:1}})),v({page:1,tab:x,query:u})):0===b[x].results.length&&v({page:1,tab:x,query:""}))},[o,x,u,b,v]);const N=()=>{const e=b[x];e.results.length<e.totalDocs&&v({page:e.page+1})},w=(e,t=x)=>{h(s=>{const a=e(s[t]);return{...s,[t]:a}})};return t.useEffect(()=>{null===o&&d("/signin")},[o,d]),a.jsx(n,{children:a.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-10 min-h-screen",children:[a.jsx(r,{}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2 ml-10 lg:ml-0",children:"Manage Blogs"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 ml-10 lg:ml-0",children:"Create, edit, and manage your content efficiently."})]}),a.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[a.jsxs("div",{className:"relative flex-1 md:w-64 group",children:[a.jsx("input",{type:"search",value:u,onChange:e=>{const t=e.target.value;m(t)},onKeyDown:e=>{e.key},placeholder:"Search...",className:"w-full pl-10 pr-4 py-2.5 rounded-full bg-gray-100 dark:bg-[#212121] border-transparent focus:bg-white dark:focus:bg-[#212121] border focus:border-gray-300 dark:focus:border-gray-700 outline-none transition-all duration-300 text-gray-900 dark:text-gray-100 placeholder:text-gray-400"}),a.jsx(f,{className:"absolute left-3.5 top-3 text-gray-400 group-focus-within:text-gray-600 dark:group-focus-within:text-gray-200 transition-colors",size:18})]}),a.jsxs(l,{to:"/editor",className:"hidden md:flex items-center justify-center w-10 h-10 md:w-auto md:px-4 md:py-2.5 bg-gray-900 dark:bg-white text-white dark:text-black rounded-full hover:bg-gray-800 dark:hover:bg-gray-200 transition-all duration-300 shadow-lg hover:shadow-xl",children:[a.jsx(y,{className:"md:mr-2",size:20}),a.jsx("span",{className:"hidden md:inline font-medium",children:"Write"})]})]})]}),a.jsx(l,{to:"/editor",className:"md:hidden fixed bottom-24 right-6 z-50 w-14 h-14 bg-black dark:bg-white text-white dark:text-black rounded-full flex items-center justify-center shadow-2xl hover:scale-105 transition-transform","aria-label":"Create new blog",children:a.jsx(y,{size:24})}),a.jsxs(c,{routes:["Published","Drafts","Stories"],defaultActiveIndex:0,defaultHidden:[],onRouteChange:e=>g(e),children:[a.jsx(S,{type:"Published",state:b.Published,fetchMore:N,loading:p&&"Published"===x,setStateFunc:e=>w(e,"Published")}),a.jsx(S,{type:"Drafts",state:b.Drafts,fetchMore:N,loading:p&&"Drafts"===x,setStateFunc:e=>w(e,"Drafts")}),a.jsx(S,{type:"Stories",state:b.Stories,fetchMore:N,loading:p&&"Stories"===x,setStateFunc:e=>w(e,"Stories")})]})]})})},S=({type:e,state:t,fetchMore:s,loading:r,setStateFunc:l})=>a.jsxs("div",{className:"py-6",children:[0!==t.results.length||r?a.jsx("div",{className:"space-y-4",children:t.results.map((t,s)=>a.jsx(n,{transition:{delay:.05*s},children:"Drafts"===e?a.jsx(N,{blog:{...t,index:s,setStateFuc:l}}):a.jsx(k,{blog:{...t,index:s,setStateFuc:l}})},s))}):a.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center border-2 border-dashed border-gray-200 dark:border-gray-800 rounded-2xl bg-gray-50/50 dark:bg-zinc-900/50",children:[a.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-full mb-4",children:"Drafts"===e?a.jsx(y,{size:32,className:"text-gray-400"}):a.jsx(f,{size:32,className:"text-gray-400"})}),a.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-200",children:["No ",e.toLowerCase()," found"]}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1 max-w-sm",children:"Published"===e?"Start writing your first blog post today!":"You don't have nothing in drafts."})]}),r&&a.jsx("div",{className:"flex justify-center py-10",children:a.jsx(x,{})}),t.totalDocs>t.results.length&&!r&&a.jsx("button",{onClick:s,className:"w-full py-3 mt-8 text-sm font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl transition-colors",children:"Load More"})]});export{D as default};
