import{i as e,g as s,r as t,j as r,H as a,w as n,N as i,a as l,x as o}from"./index-CuIw7dka.js";import{S as c}from"./StoryCard-nLAty3iw.js";const d=()=>r.jsx("div",{className:"w-full h-48 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}),g=(e,s=4)=>{const t=[];return e.forEach((e,a)=>{t.push(e),(a+1)%s===0&&t.push(r.jsx("div",{className:"col-span-full lg:col-span-4",children:r.jsx(o,{})},`ad-${a}`))}),t};function u(){const{pathname:o}=e(),u=s(),x=o.includes("trending"),m=x?"/trending-stories-pagination":"/stories-pagination-latest",h=x?"Trending Stories":"Latest Stories",[p,b]=t.useState([]),[j,y]=t.useState(null),[f,v]=t.useState(!0),[S,k]=t.useState(!0),w=t.useRef(),N=async(e=null)=>{k(!0);try{const{data:s}=await l.post(m,{limit:8,cursor:e});if(b(t=>e?[...t,...s.stories]:s.stories),v(s.hasMore),s.stories.length){const e=s.stories[s.stories.length-1];y(x?e.trendingScore:e.publishedAt)}}catch(s){}finally{k(!1)}};t.useEffect(()=>{b([]),y(null),v(!0),N()},[o]);const C=t.useCallback(e=>{S||(w.current&&w.current.disconnect(),w.current=new IntersectionObserver(e=>{e[0].isIntersecting&&f&&N(j)},{rootMargin:"200px"}),e&&w.current.observe(e))},[S,f,j]),L=({label:e,active:s,onClick:t})=>r.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium rounded-md transition-colors duration-300 "+(s?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-blue-100 dark:hover:bg-gray-700"),children:e});return r.jsxs(r.Fragment,{children:[r.jsxs(a,{children:[r.jsxs("title",{children:[h," | Shums"]}),r.jsx("meta",{name:"description",content:`Stay updated with the ${h.toLowerCase()}. Fast, SEO-optimized.`})]}),r.jsx(n,{}),r.jsxs("div",{className:"max-w-7xl mx-auto p-4",children:[r.jsxs("div",{className:"mb-6 flex justify-center space-x-4",children:[r.jsx(L,{label:"Latest",active:!x,onClick:()=>u("/stories")}),r.jsx(L,{label:"Trending",active:x,onClick:()=>u("/stories/trending")})]}),r.jsx("h1",{className:"text-3xl font-bold mb-6 text-gray-900 dark:text-gray-100",children:h}),!S&&0===p.length&&r.jsx(i,{pageType:"story"}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:S&&0===p.length?Array(8).fill().map((e,s)=>r.jsx(d,{},s)):g(p.map((e,s)=>{const t=r.jsx(c,{story:e},e.story_id);return s===p.length-1?r.jsx("div",{ref:C,children:t},e.story_id):t}),4)}),!S&&f&&r.jsx("div",{className:"mt-8 text-center",children:r.jsx("button",{onClick:()=>N(j),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition",children:"Load More"})})]})]})}export{u as default};
